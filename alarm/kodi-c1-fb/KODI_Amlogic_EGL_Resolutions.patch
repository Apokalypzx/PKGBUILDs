diff -rupN xbmc/xbmc/windowing/egl/EGLNativeTypeAmlogic.cpp xbmc-new/xbmc/windowing/egl/EGLNativeTypeAmlogic.cpp
--- xbmc/xbmc/windowing/egl/EGLNativeTypeAmlogic.cpp	2015-03-04 14:05:54.000000000 -0800
+++ xbmc-new/xbmc/windowing/egl/EGLNativeTypeAmlogic.cpp	2015-04-08 23:15:17.554048803 -0700
@@ -26,6 +26,7 @@
 
 #include <stdio.h>
 #include <stdlib.h>
+#include <fstream>
 #include <linux/fb.h>
 #include <sys/ioctl.h>
 #include <EGL/egl.h>
@@ -87,9 +88,11 @@ bool CEGLNativeTypeAmlogic::CreateNative
   fbdev_window *nativeWindow = new fbdev_window;
   if (!nativeWindow)
     return false;
+  RESOLUTION_INFO res;
+  GetPreferredResolution(&res);
 
-  nativeWindow->width = 1280;
-  nativeWindow->height = 720;
+  nativeWindow->width = res.iWidth;
+  nativeWindow->height = res.iHeight;
   m_nativeWindow = nativeWindow;
   return true;
 #else
@@ -137,11 +140,13 @@ bool CEGLNativeTypeAmlogic::SetNativeRes
 {
   switch((int)(0.5 + res.fRefreshRate))
   {
-    default:
+    case 24:
+      SetDisplayResolution("1080p24hz");
+      break;
+    case 30:
     case 60:
       switch(res.iScreenWidth)
       {
-        default:
         case 1280:
           SetDisplayResolution("720p");
           break;
@@ -153,10 +158,10 @@ bool CEGLNativeTypeAmlogic::SetNativeRes
           break;
       }
       break;
+    case 25:
     case 50:
       switch(res.iScreenWidth)
       {
-        default:
         case 1280:
           SetDisplayResolution("720p50hz");
           break;
@@ -168,14 +173,7 @@ bool CEGLNativeTypeAmlogic::SetNativeRes
           break;
       }
       break;
-    case 30:
-      SetDisplayResolution("1080p30hz");
-      break;
-    case 24:
-      SetDisplayResolution("1080p24hz");
-      break;
   }
-
   return true;
 }
 
@@ -183,7 +181,26 @@ bool CEGLNativeTypeAmlogic::ProbeResolut
 {
   std::string valstr;
   SysfsUtils::GetString("/sys/class/amhdmitx/amhdmitx0/disp_cap", valstr);
-  std::vector<std::string> probe_str = StringUtils::Split(valstr, "\n");
+  std::vector<std::string> probe_str;
+  std::string resentry;
+  std::ifstream resfile ("/etc/kodi-resolutions.conf");
+  if (resfile.is_open()) {
+    while (getline(resfile,resentry)) {
+      if (!resentry.empty()) {
+        if (resentry[0] != '#') {
+          probe_str.push_back(resentry);
+        }
+      }
+    }
+  } else {
+  probe_str.push_back("720p");
+  probe_str.push_back("1080p24hz");
+  probe_str.push_back("1080p");
+  probe_str.push_back("1080i60hz");
+  probe_str.push_back("720p50hz");
+  probe_str.push_back("1080p50hz");
+  probe_str.push_back("1080i50hz");
+  }
 
   resolutions.clear();
   RESOLUTION_INFO res;
@@ -220,61 +237,29 @@ bool CEGLNativeTypeAmlogic::SetDisplayRe
   std::string mode = resolution;
   // switch display resolution
   SysfsUtils::SetString("/sys/class/display/mode", mode.c_str());
-  SetupVideoScaling(mode.c_str());
-
-  return true;
-}
-
-void CEGLNativeTypeAmlogic::SetupVideoScaling(const char *mode)
-{
-  SysfsUtils::SetInt("/sys/class/graphics/fb0/blank",      1);
-  SysfsUtils::SetInt("/sys/class/graphics/fb0/free_scale", 0);
-  SysfsUtils::SetInt("/sys/class/graphics/fb1/free_scale", 0);
-  SysfsUtils::SetInt("/sys/class/ppmgr/ppscaler",          0);
 
-  if (strstr(mode, "1080"))
+  RESOLUTION_INFO res; 
+  if(aml_mode_to_resolution(mode.c_str(), &res)) 
   {
-    SysfsUtils::SetString("/sys/class/graphics/fb0/request2XScale", "8");
-    SysfsUtils::SetString("/sys/class/graphics/fb1/scale_axis",     "1280 720 1920 1080");
-    SysfsUtils::SetString("/sys/class/graphics/fb1/scale",          "0x10001");
-  }
-  else
-  {
-    SysfsUtils::SetString("/sys/class/graphics/fb0/request2XScale", "16 1280 720");
+    int fd0;
+    std::string framebuffer = "/dev/" + m_framebuffer_name;
+    if ((fd0 = open(framebuffer.c_str(), O_RDWR)) >= 0)
+    {
+      struct fb_var_screeninfo vinfo;
+      if (ioctl(fd0, FBIOGET_VSCREENINFO, &vinfo) == 0)
+      {
+        vinfo.xres = res.iWidth;
+        vinfo.yres = res.iHeight;
+        vinfo.xres_virtual = vinfo.xres;
+        vinfo.yres_virtual = vinfo.yres*2;
+        vinfo.bits_per_pixel = 32;
+        vinfo.activate = FB_ACTIVATE_ALL;
+        ioctl(fd0, FBIOPUT_VSCREENINFO, &vinfo);
+      }
+      close(fd0);
+    }
   }
-
-  SysfsUtils::SetInt("/sys/class/graphics/fb0/blank", 0);
-}
-
-void CEGLNativeTypeAmlogic::EnableFreeScale()
-{
-  // enable OSD free scale using frame buffer size of 720p
-  SysfsUtils::SetInt("/sys/class/graphics/fb0/free_scale", 0);
-  SysfsUtils::SetInt("/sys/class/graphics/fb1/free_scale", 0);
-  SysfsUtils::SetInt("/sys/class/graphics/fb0/scale_width",  1280);
-  SysfsUtils::SetInt("/sys/class/graphics/fb0/scale_height", 720);
-  SysfsUtils::SetInt("/sys/class/graphics/fb1/scale_width",  1280);
-  SysfsUtils::SetInt("/sys/class/graphics/fb1/scale_height", 720);
-
-  // enable video free scale (scaling to 1920x1080 with frame buffer size 1280x720)
-  SysfsUtils::SetInt("/sys/class/ppmgr/ppscaler", 0);
-  SysfsUtils::SetInt("/sys/class/video/disable_video", 1);
-  SysfsUtils::SetInt("/sys/class/ppmgr/ppscaler", 1);
-  SysfsUtils::SetString("/sys/class/ppmgr/ppscaler_rect", "0 0 1919 1079 0");
-  SysfsUtils::SetString("/sys/class/ppmgr/disp", "1280 720");
-  //
-  SysfsUtils::SetInt("/sys/class/graphics/fb0/scale_width",  1280);
-  SysfsUtils::SetInt("/sys/class/graphics/fb0/scale_height", 720);
-  SysfsUtils::SetInt("/sys/class/graphics/fb1/scale_width",  1280);
-  SysfsUtils::SetInt("/sys/class/graphics/fb1/scale_height", 720);
-  //
-  SysfsUtils::SetInt("/sys/class/video/disable_video", 2);
-  SysfsUtils::SetString("/sys/class/display/axis", "0 0 1279 719 0 0 0 0");
-  SysfsUtils::SetString("/sys/class/ppmgr/ppscaler_rect", "0 0 1279 719 1");
-  //
-  SysfsUtils::SetInt("/sys/class/graphics/fb0/free_scale", 1);
-  SysfsUtils::SetInt("/sys/class/graphics/fb1/free_scale", 1);
-  SysfsUtils::SetString("/sys/class/graphics/fb0/free_scale_axis", "0 0 1279 719");
+  return true;
 }
 
 void CEGLNativeTypeAmlogic::DisableFreeScale()
@@ -282,26 +267,11 @@ void CEGLNativeTypeAmlogic::DisableFreeS
   // turn off frame buffer freescale
   SysfsUtils::SetInt("/sys/class/graphics/fb0/free_scale", 0);
   SysfsUtils::SetInt("/sys/class/graphics/fb1/free_scale", 0);
-  SysfsUtils::SetString("/sys/class/graphics/fb0/free_scale_axis", "0 0 1279 719");
-
-  SysfsUtils::SetInt("/sys/class/ppmgr/ppscaler", 0);
-  SysfsUtils::SetInt("/sys/class/video/disable_video", 0);
-  // now default video display to off
-  SysfsUtils::SetInt("/sys/class/video/disable_video", 1);
-
-  // revert display axis
-  int fd0;
-  std::string framebuffer = "/dev/" + m_framebuffer_name;
+}
 
-  if ((fd0 = open(framebuffer.c_str(), O_RDWR)) >= 0)
-  {
-    struct fb_var_screeninfo vinfo;
-    if (ioctl(fd0, FBIOGET_VSCREENINFO, &vinfo) == 0)
-    {
-      char daxis_str[256] = {0};
-      sprintf(daxis_str, "%d %d %d %d 0 0 0 0", 0, 0, vinfo.xres-1, vinfo.yres-1);
-      SysfsUtils::SetString("/sys/class/display/axis", daxis_str);
-    }
-    close(fd0);
-  }
+bool CEGLNativeTypeAmlogic::IsHdmiConnected() const
+{
+  std::string hpd_state;
+  SysfsUtils::GetString("/sys/class/amhdmitx/amhdmitx0/hpd_state", hpd_state);
+  return hpd_state.at(0) == '1';
 }
diff -rupN xbmc/xbmc/windowing/egl/EGLNativeTypeAmlogic.h xbmc-new/xbmc/windowing/egl/EGLNativeTypeAmlogic.h
--- xbmc/xbmc/windowing/egl/EGLNativeTypeAmlogic.h	2015-03-04 14:05:54.000000000 -0800
+++ xbmc-new/xbmc/windowing/egl/EGLNativeTypeAmlogic.h	2015-04-08 23:15:17.564048829 -0700
@@ -49,10 +49,9 @@ public:
 
 protected:
   bool SetDisplayResolution(const char *resolution);
-  void SetupVideoScaling(const char *mode);
-  void EnableFreeScale();
   void DisableFreeScale();
 
 private:
   std::string m_framebuffer_name;
+  bool IsHdmiConnected() const;
 };
